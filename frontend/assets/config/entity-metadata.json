{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://trossapp.com/schemas/entity-metadata.json",
  "title": "TrossApp Entity Metadata",
  "description": "Frontend mirror of backend entity metadata. Auto-generated by sync-entity-metadata.js",
  "version": "1.0.0",
  "lastModified": "2026-01-01",
  "user": {
    "tableName": "users",
    "primaryKey": "id",
    "identityField": "email",
    "rlsResource": "users",
    "displayName": "User",
    "displayNamePlural": "Users",
    "requiredFields": [
      "email",
      "first_name",
      "last_name"
    ],
    "immutableFields": [
      "email",
      "auth0_id"
    ],
    "searchableFields": [
      "first_name",
      "last_name",
      "email"
    ],
    "filterableFields": [
      "id",
      "email",
      "auth0_id",
      "first_name",
      "last_name",
      "role_id",
      "is_active",
      "status",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "email",
      "first_name",
      "last_name",
      "role_id",
      "is_active",
      "status",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "role_id": {
        "relatedEntity": "role",
        "displayField": "name",
        "type": "belongsTo"
      },
      "customer_profile_id": {
        "relatedEntity": "customer",
        "displayField": "email",
        "type": "belongsTo"
      },
      "technician_profile_id": {
        "relatedEntity": "technician",
        "displayField": "email",
        "type": "belongsTo"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "email": {
        "type": "email",
        "required": true,
        "maxLength": 255
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "active",
        "values": [
          "pending_activation",
          "active",
          "suspended"
        ]
      },
      "auth0_id": {
        "type": "string",
        "readonly": true,
        "maxLength": 255
      },
      "first_name": {
        "type": "string",
        "maxLength": 100
      },
      "last_name": {
        "type": "string",
        "maxLength": 100
      },
      "role_id": {
        "type": "foreignKey",
        "relatedEntity": "role",
        "displayField": "name"
      },
      "customer_profile_id": {
        "type": "foreignKey",
        "relatedEntity": "customer",
        "displayField": "email",
        "readonly": true
      },
      "technician_profile_id": {
        "type": "foreignKey",
        "relatedEntity": "technician",
        "displayField": "email",
        "readonly": true
      }
    }
  },
  "role": {
    "tableName": "roles",
    "primaryKey": "id",
    "identityField": "priority",
    "rlsResource": "roles",
    "displayName": "Role",
    "displayNamePlural": "Roles",
    "requiredFields": [
      "name",
      "priority"
    ],
    "searchableFields": [
      "name",
      "description"
    ],
    "filterableFields": [
      "id",
      "name",
      "description",
      "priority",
      "status",
      "is_active",
      "is_system_role",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "name",
      "description",
      "priority",
      "status",
      "is_active",
      "is_system_role",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "priority",
      "order": "DESC"
    },
    "systemProtected": {
      "protectedByField": "name",
      "values": [
        "admin",
        "manager",
        "dispatcher",
        "technician",
        "customer"
      ],
      "immutableFields": [
        "name",
        "priority"
      ],
      "preventDelete": true
    },
    "relationships": {
      "role_id": {
        "relatedEntity": "user",
        "displayField": "email",
        "type": "hasMany"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "name": {
        "type": "string",
        "required": true,
        "maxLength": 50
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "active",
        "values": [
          "active",
          "disabled"
        ]
      },
      "description": {
        "type": "text"
      },
      "priority": {
        "type": "integer",
        "required": true,
        "min": 1
      }
    }
  },
  "customer": {
    "tableName": "customers",
    "primaryKey": "id",
    "identityField": "email",
    "rlsResource": "customers",
    "displayName": "Customer",
    "displayNamePlural": "Customers",
    "requiredFields": [
      "email",
      "first_name",
      "last_name"
    ],
    "searchableFields": [
      "first_name",
      "last_name",
      "email",
      "phone",
      "organization_name"
    ],
    "filterableFields": [
      "id",
      "email",
      "first_name",
      "last_name",
      "phone",
      "organization_name",
      "is_active",
      "status",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "email",
      "first_name",
      "last_name",
      "organization_name",
      "is_active",
      "status",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "customer_id": {
        "relatedEntity": "contract",
        "displayField": "contract_number",
        "type": "hasMany"
      },
      "customer_profile_id": {
        "relatedEntity": "user",
        "displayField": "email",
        "type": "hasOne"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "email": {
        "type": "email",
        "required": true,
        "maxLength": 255
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "pending",
        "values": [
          "pending",
          "active",
          "suspended"
        ]
      },
      "first_name": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "last_name": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "phone": {
        "type": "phone",
        "maxLength": 50
      },
      "organization_name": {
        "type": "string",
        "maxLength": 255
      },
      "billing_address": {
        "type": "jsonb"
      },
      "service_address": {
        "type": "jsonb"
      }
    }
  },
  "technician": {
    "tableName": "technicians",
    "primaryKey": "id",
    "identityField": "email",
    "rlsResource": "technicians",
    "displayName": "Technician",
    "displayNamePlural": "Technicians",
    "requiredFields": [
      "email",
      "first_name",
      "last_name"
    ],
    "searchableFields": [
      "first_name",
      "last_name",
      "email",
      "license_number"
    ],
    "filterableFields": [
      "id",
      "email",
      "first_name",
      "last_name",
      "license_number",
      "is_active",
      "status",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "email",
      "first_name",
      "last_name",
      "license_number",
      "is_active",
      "status",
      "hourly_rate",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "assigned_technician_id": {
        "relatedEntity": "work_order",
        "displayField": "work_order_number",
        "type": "hasMany"
      },
      "technician_profile_id": {
        "relatedEntity": "user",
        "displayField": "email",
        "type": "hasOne"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "email": {
        "type": "email",
        "required": true,
        "maxLength": 255
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "available",
        "values": [
          "available",
          "on_job",
          "off_duty",
          "suspended"
        ]
      },
      "first_name": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "last_name": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "license_number": {
        "type": "string",
        "maxLength": 100
      },
      "certifications": {
        "type": "jsonb"
      },
      "skills": {
        "type": "jsonb"
      },
      "hourly_rate": {
        "type": "decimal"
      }
    }
  },
  "work_order": {
    "tableName": "work_orders",
    "primaryKey": "id",
    "identityField": "work_order_number",
    "rlsResource": "work_orders",
    "displayName": "Work order",
    "displayNamePlural": "Work orders",
    "requiredFields": [
      "customer_id"
    ],
    "immutableFields": [
      "work_order_number"
    ],
    "searchableFields": [
      "work_order_number",
      "name",
      "summary"
    ],
    "filterableFields": [
      "id",
      "work_order_number",
      "name",
      "customer_id",
      "assigned_technician_id",
      "is_active",
      "status",
      "priority",
      "scheduled_start",
      "scheduled_end",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "work_order_number",
      "name",
      "priority",
      "status",
      "scheduled_start",
      "scheduled_end",
      "completed_at",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "customer_id": {
        "relatedEntity": "customer",
        "displayField": "email",
        "type": "belongsTo"
      },
      "assigned_technician_id": {
        "relatedEntity": "technician",
        "displayField": "email",
        "type": "belongsTo"
      },
      "work_order_id": {
        "relatedEntity": "invoice",
        "displayField": "invoice_number",
        "type": "hasMany"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "work_order_number": {
        "type": "string",
        "readonly": true,
        "maxLength": 100
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "pending",
        "values": [
          "pending",
          "assigned",
          "in_progress",
          "completed",
          "cancelled"
        ]
      },
      "name": {
        "type": "string",
        "required": true,
        "maxLength": 255
      },
      "summary": {
        "type": "string",
        "maxLength": 255
      },
      "priority": {
        "type": "enum",
        "default": "normal",
        "values": [
          "low",
          "normal",
          "high",
          "urgent"
        ]
      },
      "customer_id": {
        "type": "foreignKey",
        "relatedEntity": "customer",
        "displayField": "email",
        "required": true
      },
      "assigned_technician_id": {
        "type": "foreignKey",
        "relatedEntity": "technician",
        "displayField": "email"
      },
      "scheduled_start": {
        "type": "timestamp"
      },
      "scheduled_end": {
        "type": "timestamp"
      },
      "completed_at": {
        "type": "timestamp"
      }
    }
  },
  "contract": {
    "tableName": "contracts",
    "primaryKey": "id",
    "identityField": "contract_number",
    "rlsResource": "contracts",
    "displayName": "Contract",
    "displayNamePlural": "Contracts",
    "requiredFields": [
      "customer_id",
      "start_date"
    ],
    "immutableFields": [
      "contract_number"
    ],
    "searchableFields": [
      "contract_number",
      "name",
      "summary"
    ],
    "filterableFields": [
      "id",
      "contract_number",
      "customer_id",
      "is_active",
      "status",
      "start_date",
      "end_date",
      "billing_cycle",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "contract_number",
      "status",
      "value",
      "start_date",
      "end_date",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "customer_id": {
        "relatedEntity": "customer",
        "displayField": "email",
        "type": "belongsTo"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "contract_number": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "draft",
        "values": [
          "draft",
          "active",
          "expired",
          "cancelled"
        ]
      },
      "name": {
        "type": "string",
        "maxLength": 255
      },
      "summary": {
        "type": "string",
        "maxLength": 255
      },
      "customer_id": {
        "type": "foreignKey",
        "relatedEntity": "customer",
        "displayField": "email",
        "required": true
      },
      "start_date": {
        "type": "date",
        "required": true
      },
      "end_date": {
        "type": "date"
      },
      "terms": {
        "type": "text"
      },
      "value": {
        "type": "decimal"
      },
      "billing_cycle": {
        "type": "enum",
        "values": [
          "monthly",
          "quarterly",
          "annually",
          "one_time"
        ]
      }
    }
  },
  "invoice": {
    "tableName": "invoices",
    "primaryKey": "id",
    "identityField": "invoice_number",
    "rlsResource": "invoices",
    "displayName": "Invoice",
    "displayNamePlural": "Invoices",
    "requiredFields": [
      "customer_id",
      "amount",
      "total"
    ],
    "immutableFields": [
      "invoice_number"
    ],
    "searchableFields": [
      "invoice_number",
      "name",
      "summary"
    ],
    "filterableFields": [
      "id",
      "invoice_number",
      "customer_id",
      "work_order_id",
      "is_active",
      "status",
      "due_date",
      "paid_at",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "invoice_number",
      "status",
      "amount",
      "total",
      "due_date",
      "paid_at",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "customer_id": {
        "relatedEntity": "customer",
        "displayField": "email",
        "type": "belongsTo"
      },
      "work_order_id": {
        "relatedEntity": "work_order",
        "displayField": "work_order_number",
        "type": "belongsTo"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "invoice_number": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "draft",
        "values": [
          "draft",
          "sent",
          "paid",
          "overdue",
          "cancelled"
        ]
      },
      "name": {
        "type": "string",
        "maxLength": 255
      },
      "summary": {
        "type": "string",
        "maxLength": 255
      },
      "work_order_id": {
        "type": "foreignKey",
        "relatedEntity": "work_order",
        "displayField": "work_order_number"
      },
      "customer_id": {
        "type": "foreignKey",
        "relatedEntity": "customer",
        "displayField": "email",
        "required": true
      },
      "amount": {
        "type": "decimal",
        "required": true
      },
      "tax": {
        "type": "decimal",
        "default": 0
      },
      "total": {
        "type": "decimal",
        "required": true
      },
      "due_date": {
        "type": "date"
      },
      "paid_at": {
        "type": "timestamp"
      }
    }
  },
  "inventory": {
    "tableName": "inventory",
    "primaryKey": "id",
    "identityField": "sku",
    "rlsResource": "inventory",
    "displayName": "Inventory",
    "displayNamePlural": "Inventory",
    "requiredFields": [
      "name",
      "sku"
    ],
    "immutableFields": [
      "sku"
    ],
    "searchableFields": [
      "name",
      "sku",
      "description"
    ],
    "filterableFields": [
      "id",
      "name",
      "sku",
      "is_active",
      "status",
      "quantity",
      "reorder_level",
      "location",
      "supplier",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "name",
      "sku",
      "status",
      "quantity",
      "unit_cost",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "name": {
        "type": "string",
        "required": true,
        "maxLength": 255
      },
      "is_active": {
        "type": "boolean",
        "default": true
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      },
      "status": {
        "type": "enum",
        "default": "in_stock",
        "values": [
          "in_stock",
          "low_stock",
          "out_of_stock",
          "discontinued"
        ]
      },
      "sku": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "description": {
        "type": "text"
      },
      "quantity": {
        "type": "integer",
        "default": 0
      },
      "reorder_level": {
        "type": "integer",
        "default": 10
      },
      "unit_cost": {
        "type": "decimal"
      },
      "location": {
        "type": "string",
        "maxLength": 255
      },
      "supplier": {
        "type": "string",
        "maxLength": 255
      }
    }
  },
  "preferences": {
    "tableName": "user_preferences",
    "primaryKey": "id",
    "identityField": "id",
    "rlsResource": "preferences",
    "displayName": "Preferences",
    "displayNamePlural": "Preferenceses",
    "requiredFields": [
      "id"
    ],
    "immutableFields": [
      "id"
    ],
    "filterableFields": [
      "id",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "id",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "DESC"
    },
    "relationships": {
      "id": {
        "relatedEntity": "user",
        "displayField": "email",
        "type": "belongsTo"
      }
    },
    "fields": {
      "id": {
        "type": "foreignKey",
        "relatedEntity": "user",
        "displayField": "email",
        "required": true,
        "readonly": true
      },
      "preferences": {
        "type": "jsonb",
        "default": {}
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      }
    },
    "preferenceSchema": {
      "theme": {
        "type": "enum",
        "values": [
          "system",
          "light",
          "dark"
        ],
        "default": "system",
        "label": "Theme",
        "description": "Choose your preferred color theme",
        "displayLabels": {
          "system": "System Default",
          "light": "Light",
          "dark": "Dark"
        },
        "order": 0
      },
      "notificationsEnabled": {
        "type": "boolean",
        "default": true,
        "label": "Notifications",
        "description": "Receive notifications about updates",
        "order": 1
      },
      "defaultPageSize": {
        "type": "enum",
        "values": [
          "10",
          "25",
          "50",
          "100"
        ],
        "default": "25",
        "label": "Default Page Size",
        "description": "Number of rows to display in tables",
        "displayLabels": {
          "10": "10 rows",
          "25": "25 rows",
          "50": "50 rows",
          "100": "100 rows"
        },
        "order": 2
      },
      "tableDensity": {
        "type": "enum",
        "values": [
          "compact",
          "standard",
          "comfortable"
        ],
        "default": "standard",
        "label": "Table Density",
        "description": "Spacing between table rows",
        "displayLabels": {
          "compact": "Compact",
          "standard": "Standard",
          "comfortable": "Comfortable"
        },
        "order": 3
      }
    }
  },
  "saved_view": {
    "tableName": "user_saved_view",
    "primaryKey": "id",
    "identityField": "view_name",
    "rlsResource": "saved_views",
    "displayName": "Saved view",
    "displayNamePlural": "Saved views",
    "requiredFields": [
      "user_id",
      "entity_name",
      "view_name",
      "settings"
    ],
    "immutableFields": [
      "id",
      "user_id"
    ],
    "searchableFields": [
      "view_name"
    ],
    "filterableFields": [
      "user_id",
      "entity_name",
      "is_default",
      "created_at",
      "updated_at"
    ],
    "sortableFields": [
      "view_name",
      "entity_name",
      "is_default",
      "created_at",
      "updated_at"
    ],
    "defaultSort": {
      "field": "view_name",
      "order": "ASC"
    },
    "relationships": {
      "user_id": {
        "relatedEntity": "user",
        "displayField": "email",
        "type": "belongsTo"
      }
    },
    "fields": {
      "id": {
        "type": "integer",
        "readonly": true
      },
      "user_id": {
        "type": "foreignKey",
        "relatedEntity": "user",
        "displayField": "email",
        "required": true,
        "readonly": true
      },
      "entity_name": {
        "type": "string",
        "required": true,
        "maxLength": 50
      },
      "view_name": {
        "type": "string",
        "required": true,
        "maxLength": 100
      },
      "settings": {
        "type": "jsonb",
        "required": true,
        "default": {}
      },
      "is_default": {
        "type": "boolean",
        "default": false
      },
      "created_at": {
        "type": "timestamp",
        "readonly": true
      },
      "updated_at": {
        "type": "timestamp",
        "readonly": true
      }
    }
  },
  "file_attachment": {
    "tableName": "file_attachments",
    "primaryKey": "id",
    "identityField": "original_filename",
    "rlsResource": "file_attachments",
    "displayName": "File attachment",
    "displayNamePlural": "File attachments",
    "requiredFields": [
      "entity_type",
      "entity_id",
      "original_filename",
      "storage_key",
      "mime_type",
      "file_size"
    ],
    "immutableFields": [
      "entity_type",
      "entity_id",
      "original_filename",
      "storage_key",
      "mime_type",
      "file_size",
      "uploaded_by"
    ],
    "searchableFields": [
      "original_filename",
      "description"
    ],
    "filterableFields": [
      "entity_type",
      "entity_id",
      "mime_type",
      "category",
      "is_active",
      "uploaded_by"
    ],
    "sortableFields": [
      "original_filename",
      "file_size",
      "created_at",
      "category"
    ],
    "defaultSort": {
      "field": "created_at",
      "order": "desc"
    },
    "fields": {}
  }
}