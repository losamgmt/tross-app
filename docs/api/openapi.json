{
  "openapi": "3.0.0",
  "info": {
    "title": "TrossApp API",
    "version": "1.0.0",
    "description": "\n        TrossApp Backend REST API - Skills-based work order management system.\n        \n        **Current Status:** MVP Foundation API\n        \n        This documentation covers the foundational authentication, user management, \n        and role-based access control endpoints. Business logic endpoints will be \n        added as features are developed.\n        \n        ## Authentication\n        \n        Most endpoints require a Bearer token in the Authorization header:\n        ```\n        Authorization: Bearer <your-jwt-token>\n        ```\n        \n        ## Dual Authentication Strategy\n        \n        - **Development Mode:** JWT-based authentication with test users\n        - **Production Mode:** Auth0 OAuth2/OIDC (currently stubs, full implementation planned)\n        \n        ## Response Format\n        \n        All successful responses follow this format:\n        ```json\n        {\n          \"success\": true,\n          \"data\": {...},\n          \"timestamp\": \"2025-10-16T12:00:00.000Z\"\n        }\n        ```\n        \n        Error responses:\n        ```json\n        {\n          \"error\": \"Error Type\",\n          \"message\": \"Detailed error message\",\n          \"timestamp\": \"2025-10-16T12:00:00.000Z\"\n        }\n        ```\n      ",
    "contact": {
      "name": "TrossApp Team",
      "email": "dev@trossapp.com"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3001",
      "description": "Development server"
    },
    {
      "url": "https://api.trossapp.com",
      "description": "Production server (future)"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT token from /api/dev/token (dev) or Auth0 (prod)"
      }
    },
    "schemas": {
      "Error": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error type",
            "example": "Bad Request"
          },
          "message": {
            "type": "string",
            "description": "Detailed error message",
            "example": "Email is required"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp",
            "example": "2025-10-16T12:00:00.000Z"
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "User ID",
            "example": 1
          },
          "auth0_id": {
            "type": "string",
            "description": "Auth0 subject ID",
            "example": "auth0|507f1f77bcf86cd799439011"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "User email address",
            "example": "user@example.com"
          },
          "first_name": {
            "type": "string",
            "nullable": true,
            "description": "First name",
            "example": "John"
          },
          "last_name": {
            "type": "string",
            "nullable": true,
            "description": "Last name",
            "example": "Doe"
          },
          "role": {
            "type": "string",
            "nullable": true,
            "description": "User role name",
            "example": "admin"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Account creation timestamp"
          }
        }
      },
      "Role": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Role ID",
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "Role name",
            "example": "admin"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "description": "Role description",
            "example": "Administrator with full system access"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Role creation timestamp"
          }
        }
      },
      "Session": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Session token ID"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Session creation time"
          },
          "lastUsedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity time"
          },
          "expiresAt": {
            "type": "string",
            "format": "date-time",
            "description": "Session expiration time"
          },
          "ipAddress": {
            "type": "string",
            "nullable": true,
            "description": "IP address",
            "example": "192.168.1.1"
          },
          "userAgent": {
            "type": "string",
            "nullable": true,
            "description": "Browser/client user agent"
          },
          "isCurrent": {
            "type": "boolean",
            "description": "Whether this is the current session"
          }
        }
      },
      "HealthStatus": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": ["healthy", "degraded", "critical"],
            "description": "Overall system health status"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "uptime": {
            "type": "number",
            "description": "Server uptime in seconds"
          },
          "environment": {
            "type": "string",
            "example": "development"
          },
          "version": {
            "type": "string",
            "example": "1.0.0"
          },
          "services": {
            "type": "object",
            "properties": {
              "database": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": ["healthy", "unhealthy"]
                  },
                  "database": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "example": "PostgreSQL"
                  }
                }
              },
              "memory": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": ["normal", "warning", "critical"]
                  },
                  "memory": {
                    "type": "string",
                    "example": "42MB"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Health",
      "description": "System health and monitoring endpoints"
    },
    {
      "name": "Authentication",
      "description": "User authentication and session management (Development mode)"
    },
    {
      "name": "Auth0",
      "description": "Auth0 OAuth2/OIDC endpoints (Production mode - stubs)"
    },
    {
      "name": "Users",
      "description": "User management endpoints (admin only)"
    },
    {
      "name": "Roles",
      "description": "Role management and user-role assignment"
    },
    {
      "name": "Development",
      "description": "Development-only utilities (disabled in production)"
    }
  ],
  "paths": {}
}
